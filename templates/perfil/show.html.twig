{% extends 'base.html.twig' %}
{% block title %}{{ perfil.nombre }} | Perfil · TalentoDev{% endblock %}
{# {% block stylesheets %}
{{ parent() }}
<style>
  :root{ --brand-color:#226aff; }
  .profile-card{
    border:1px solid rgba(30,40,60,.06);
    border-radius:18px;
    box-shadow:0 8px 24px rgba(30,40,60,.07);
    overflow:hidden;
    background:#fff;
  }
  .profile-hero{
    background: linear-gradient(180deg, #ffffff 0%, #f6f8fa 60%);
    border-bottom:1px solid rgba(34,106,255,.12);
    height:60px; /* Reducido de 110px */
  }
  .avatar-wrap{ margin-top:-50px; } /* Ajustado de -42px */
  
  .profile-avatar{
    width:100px;height:100px;object-fit:cover;border-radius:999px; /* Reducido de 110px */
    box-shadow:0 8px 22px rgba(34,106,255,.15);
    background:#e9ecef;border:3px solid #fff;
  }
  @media(max-width:575px){ 
    .profile-avatar{ width:80px;height:80px; } /* Reducido de 90px */
    .avatar-wrap{ margin-top:-40px; } /* Ajustado de -34px */
  }

  .rep-badge{
    background:#22c55e1a;color:#22c55e;border:1px solid #22c55e33;
    font-weight:600;
  }
  .chip{
    border:1px solid #dbe6ff;
    background:#eff5ff;
    color:var(--brand-color);
    font-weight:500;
  }
  .meta-kpi .card{ border:1px solid rgba(30,40,60,.06); }

  /* -- NUEVOS ESTILOS PARA PORTFOLIO -- */
  .project-card {
    border: 1px solid rgba(30, 40, 60, .08);
    border-radius: 12px;
    background: #fafbff;
    transition: all 0.2s ease;
  }
  .project-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(30, 40, 60, .08);
  }
  .project-icon {
    font-size: 1.5rem;
    color: var(--brand-color);
    background: #eff5ff;
    border-radius: 8px;
    width: 40px;
    height: 40px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
</style>
{% endblock %} #}

{% block body %}
<div class="profile-card">
  <div class="profile-hero"></div>

  <div class="p-4 pb-0">
    <div class="d-flex align-items-start gap-3 flex-wrap">
      <div class="avatar-wrap">
        <img src="{{ perfil.avatar_url }}"
             class="profile-avatar"
             alt="Avatar de {{ perfil.nombre }}"
             onerror="this.src='https://ui-avatars.com/api/?name={{ perfil.nombre|url_encode }}&background=226aff&color=fff'">
      </div>

      <div class="flex-grow-1">
        <h1 class="h4 mb-1 fw-bold">{{ perfil.nombre }}</h1>
        <div class="text-muted small text-capitalize">{{ perfil.rol }}</div>
        <div class="mt-2 d-flex align-items-center gap-2">
          <span class="badge rep-badge">{{ perfil.reputacion }} ★</span>
          <span class="text-muted small">· {{ perfil.skills|length }} skills</span>
          <span class="text-muted small">· {{ perfil.portfolio|length }} proyectos</span>
        </div>
      </div>

      <div class="d-none d-sm-flex gap-2 ms-auto">
        <a href="{{ path('perfil_edit', {'username': perfil.username}) }}" class="btn btn-outline-primary btn-sm">
          <i class="bi bi-pencil me-1"></i> Editar
        </a>
        <a href="{{ path('perfil_delete', {'username': perfil.username}) }}" class="btn btn-outline-danger btn-sm">
          <i class="bi bi-trash me-1"></i> Eliminar
        </a>
      </div>
    </div>
  </div>

  <div class="p-4 pt-3">
    <div class="row g-3 align-items-stretch">
      <div class="col-12 col-lg-8">
        <div class="card h-100 p-3">
          <h2 class="h6 mb-2"><i class="bi bi-person-lines-fill me-1"></i> Sobre mí</h2>
          <p class="mb-0 text-secondary">{{ perfil.descripcion }}</p>
        </div>
      </div>
      <div class="col-12 col-lg-4">
        <div class="row row-cols-3 row-cols-lg-1 g-2 meta-kpi">
          <div class="col"><div class="card p-3 h-100 text-center">
            <div class="small text-muted">Reputación</div>
            <div class="fw-bold"><i class="bi bi-star-fill text-warning me-1"></i> {{ perfil.reputacion }}</div>
          </div></div>
          <div class="col"><div class="card p-3 h-100 text-center">
            <div class="small text-muted">Skills</div>
            <div class="fw-bold"><i class="bi bi-code-slash text-primary me-1"></i> {{ perfil.skills|length }}</div>
          </div></div>
          <div class="col"><div class="card p-3 h-100 text-center">
            <div class="small text-muted">Portfolio</div>
            <div class="fw-bold"><i class="bi bi-briefcase-fill text-success me-1"></i> {{ perfil.portfolio|length }}</div>
          </div></div>
        </div>
      </div>
    </div>

    <div class="mt-4 pt-4 border-top">
      <h2 class="h6 mb-2"><i class="bi bi-stars me-1"></i> Skills</h2>
      {% if perfil.skills|length %}
        <div class="d-flex flex-wrap gap-2">
          {% for skill in perfil.skills %}
            <span class="badge rounded-pill chip">{{ skill }}</span>
          {% endfor %}
        </div>
      {% else %}
        <span class="text-muted">Sin skills registradas.</span>
      {% endif %}
    </div>

    <div class="mt-4 pt-4 border-top">
      <h2 class="h6 mb-2"><i class="bi bi-briefcase me-1"></i> Portfolio</h2>
      {% if perfil.portfolio|length %}
        <div class="row g-3">
          {% for p in perfil.portfolio %}
            <div class="col-12 col-md-6">
              <a href="{{ p.url }}" class="text-decoration-none" target="_blank" rel="noopener">
                <div class="card p-3 project-card h-100">
                  <div class="d-flex align-items-start gap-3">
                    <div class="project-icon">
                      <i class="bi bi-journal-code"></i>
                    </div>
                    <div class="flex-grow-1">
                      <div class="fw-medium text-dark">{{ p.nombre }}</div>
                      {% if p.tecnologias is defined and p.tecnologias|length %}
                        <div class="small text-muted">{{ p.tecnologias|join(', ') }}</div>
                      {% endif %}
                    </div>
                    <div class="ms-auto text-muted">
                      <i class="bi bi-box-arrow-up-right small"></i>
                    </div>
                  </div>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="text-muted">Sin proyectos en el portfolio.</div>
      {% endif %}
    </div>

    <div class="d-sm-none d-flex gap-2 mt-4">
      <a href="{{ path('perfil_edit', {'username': perfil.username}) }}" class="btn btn-outline-primary btn-sm w-100">
        <i class="bi bi-pencil me-1"></i> Editar
      </a>
      <a href="{{ path('perfil_delete', {'username': perfil.username}) }}" class="btn btn-outline-danger btn-sm w-100">
        <i class="bi bi-trash me-1"></i> Eliminar
      </a>
    </div>
  </div>
</div>
{% endblock %}
